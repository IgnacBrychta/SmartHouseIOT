FUNCTION HandleSecurity : BOOL
  VAR_INPUT
  END_VAR
  VAR_IN_OUT
  END_VAR
  VAR
  END_VAR
  VAR_TEMP
  END_VAR

  IF NOT enteredPassKey = passKeyDefaultValue THEN
    IF enteredPassKey = MASTER_PASSKEY THEN
      canOpenOutsideDoors := TRUE;
      alarmON := FALSE;
      alarmTimerOFFsec := defaultAlarmTimerOFFsec;
    ELSE
      alarmON := TRUE;
      canOpenOutsideDoors := FALSE;
    END_IF;
    enteredPassKey := passKeyDefaultValue;
  END_IF;
  
  IF canOpenOutsideDoors THEN
    garageGate := garadeGateSwitch;
    garageDoor := garadeDoorSwitch;
    patioDoor := patioDoorSwitch;
    hallDoor := frontDoorSwitch
  ELSE
    garageGate := FALSE;
    garageDoor := FALSE;
    patioDoor  := FALSE;
    hallDoor   := FALSE;
  END_IF;
  
END_FUNCTION

